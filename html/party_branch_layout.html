<!DOCTYPE html>
<html>
<head>
<title>重庆大学智慧党建云平台</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="stylesheet" type="text/css" href="../css/layui.css" />
<link rel="stylesheet" type="text/css" href="../css/common.min.css" />
<link rel="stylesheet" type="text/css" href="../css/layout.min.css" />
<link rel="stylesheet" type="text/css" href="../css/summary.min.css" />
<link rel="stylesheet" type="text/css" href="../css/party_branch_layout.css" />
<script src="../js/jquery.js"></script>
<script src="../js/echarts.min.js"></script>
</head>
<div class="layout_page full_screen">
    <div class="top_nav">
        <img class="left_logo" src="../images/logo.png" alt="" title="logo"/>
        <div class="user_info_group">
            <p class="avatar_info">
                <img src="../images/avatar.png" alt="" title="头像"/>
                <span>
                    用户昵称
                    <ul class="layui-nav user_nav_container">
                        <li class="layui-nav-item">
                            <a href="javascript:;">[组织部管理员]</a>
                            <!-- <ul class="layui-nav-child">
                                <li>组织部管理员</li>
                                <li>二级党组织管理员</li>
                                <li>党支部管理员</li>
                            </ul> -->
                            <dl class="layui-nav-child">
                                <dd><a href="javascript:;">组织部管理员</a></a></dd>
                                <dd><a href="javascript:;">二级党组织管理员</a></dd>
                                <dd><a href="javascript:;">党支部管理员</a></dd>
                            </dl>
                        </li>
                    </ul>
                    
                </span>
            </p>
            <p>
                <img src="../images/change-pwd.png" alt="" title="修改密码"/>
                <span>修改密码</span>
            </p>
            <p>
                <img src="../images/exit.png" alt="" title="退出系统"/>
                <span>退出系统</span>
            </p>
        </div>
    </div>
    <div class="content_container">
        <ul class="layui-nav layui-nav-tree menu_tree" id="menu_tree" lay-filter="menuTree">
        </ul>
        <div class="main_content party_branch_outer_page">
            <!-- <iframe src="./data-statistics/summary.html"></iframe> -->
            <!-- 右侧盒子内容 -->
            <div class="summary_page party_branch_page">
                <ul class="total_account_group">
                    <li>
                        <p class="title_group">
                            <img class="title_icon" src="../images/account-icon3.png"></span>
                            <span>支部党员人数</span>
                        </p>
                        <p class="total_num">
                            <span>29999</span>个
                        </p>
                    </li>
                    <li>
                        <p class="title_group">
                            <img class="title_icon" src="../images/account-icon4.png"></span>
                            <span>全校党员数目</span>
                        </p>
                        <p class="total_num">
                            <span>29999</span>个
                        </p>
                    </li>
                </ul>
                <div class="attend_views_activity">
                    <div class="attend_views_group branch_activity_plan_group">
                        <div class="attend_rate_group">
                            <div class="operate_container">
                                <p>
                                    <img src="../images/charts-title1.png"/>
                                </p>
                                <form class="layui-form custom_form" id="selectForm1">
                                    <div class="layui-form-item">
                                        <div class="layui-input-block">
                                            <select class="custom_select terms_select" lay-filter="attend-terms-select">
                                                <option value="0">按学期</option>
                                                <option value="1">22</option>
                                                <option value="2">22</option>
                                                <option value="3">22</option>
                                                <option value="4">22222</option>
                                            </select>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class="attend_rate_container" id="attend_rate_container"></div>
                        </div>
                        <div class="views_group">
                            <div class="operate_container">
                                <p>
                                    <img src="../images/branch-charts-title2.png"/>
                                </p>
                                <form class="layui-form custom_form" id="selectForm1">
                                    <div class="layui-form-item">
                                        <div class="layui-input-block">
                                            <select class="custom_select terms_select" lay-filter="attend-terms-select">
                                                <option value="0">按学期</option>
                                                <option value="1">22</option>
                                                <option value="2">22</option>
                                                <option value="3">22</option>
                                                <option value="4">22222</option>
                                            </select>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class="attend_rate_container" id="party_class_container"></div>
                        </div>
                    </div>
                    <div class="attend_views_group branch_activity_plan_group branch_party_relation_group">
                        <div class="attend_rate_group">
                            <div class="operate_container">
                                <p>
                                    <img src="../images/branch-charts-title3.png"/>
                                </p>
                            </div>
                            <div class="attend_rate_container" id="party_relation_container"></div>
                        </div>
                        <div class="views_group">
                            <div class="operate_container">
                                <p>
                                    <img src="../images/branch-charts-title4.png"/>
                                </p>
                            </div>
                            <div class="attend_rate_container" id="party_age_container"></div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 右侧盒子内容 -->
        </div>
    </div>
</div>
<script src="../js/layui.js"></script>
<script>
    layui.use('element', function(){
        var element = layui.element;
        // element.on('nav(menuTree)', function(data){
        //     console.log(data);
        // });
    });
    //菜单list
    var menuData = [
        {
            title:'数据统计',
            link:'',
            isParent:true,
            icon:'../images/tree-icon1.png',
            children:[
                {
                    title:'数据汇总',
                    icon:'../images/tree-icon1.png',
                    link:'./data-statistics/summary.html',
                }
            ]
        },
        {
            title:'组织生活管理',
            link:'',
            isParent:true,
            icon:'../images/tree-icon2.png',
            children:[
                {
                    title:'活动管理',
                    link:'./data-statistics/summary.html',
                    icon:'../images/tree-icon2.png',
                }
            ]
        },
        {
            title:'组织关系转接',
            icon:'../images/tree-icon3.png',
            isParent:true,
            link:'',
            children:[
                {
                    title:'组织关系转出',
                    link:'./data-statistics/summary.html',
                    icon:'../images/tree-icon2.png',
                }
            ]
        },
        {
            title:'数据报送',
            icon:'../images/tree-icon4.png',
            isParent:true,
            link:'',
            children:[
                {
                    title:'数据报送11',
                    icon:'../images/tree-icon4.png',
                }
            ]
        },
        {
            title:'基础数据管理',
            icon:'../images/tree-icon5.png',
            isParent:true,
            link:'',
            children:[
                {
                    title:'基础数据管理11',
                    icon:'../images/tree-icon5.png',
                }
            ]
        },
        {
            title:'系统管理',
            icon:'../images/tree-icon6.png',
            isParent:true,
            link:'',
            children:[
                {
                    title:'系统管理11',
                    icon:'../images/tree-icon6.png',
                }
            ]
        },
    ]
    //表单
    layui.use('form', function(){
        var form = layui.form;
        //出勤率 月份 监听select
        form.on('select(attend-month-select)', function(data){
            console.log(data.value); //得到被选中的值
        });
        form.on('select(attend-terms-select)', function(data){
            console.log(data.value);
        });
        form.on('select(activity-month-select)', function(data){
            console.log(data.value);
        });
        form.on('select(activity-terms-select)', function(data){
            console.log(data.value);
        });
    });
    $(document).ready(() => {
        this.renderMenuTree();
        this.renderAttendcharts();
        this.renderViewCharts();
        this.renderActivityCharts();
        this.renderPartyAgeCharts();
    });
    //渲染左侧菜单
    function renderMenuTree(){
        var treeNodes = '';
        // var getNode = (i) => `<a href=${i.link ? i.link : 'javascript:;'}>${i.icon ? `<img class="menu_icon" src=${i.icon} />` : ''}${i.title}</a>`;
        var getNode = (i) => `<a href=${i.link ? i.link : 'javascript:;'}>${i.icon ? i.isParent ? `<img class="menu_icon" src=${i.icon} />` : `<span class="menu_icon"></span>` : ''}${i.title}</a>`;
        menuData.map(i => {
            var treeNode = `<li class=${`${(i.children || []).length ? 'layui-nav-item' : ''}`}>${getNode(i)}${
                ((i.children || []).length) ? `<ul class="layui-nav-child">${i.children.map(ii => {
                    return `<li>${getNode(ii)}</li>`;
                })}</ul>` : ''
            }</li>`;
            treeNodes += treeNode;
        })
        $("#menu_tree").html(treeNodes);
    }
    //渲染出勤率图表
    function renderAttendcharts(){
        var AttendChart = echarts.init(document.getElementById('attend_rate_container'));
        option = {
            title: {
                // text: '活动出勤率统计图',
            },
            tooltip: {
                formatter:(obj) => {
                    return `<div class="attend_tooltip">
                            <p>支部${obj.name}出勤率</p>
                            <p>${obj.seriesName}:${obj.data}%</p>
                        </div>`
                }
            },
            grid: {
                left: 0,
                right: '10%',
                top:'15%',
                bottom: '15%',
                containLabel: true
            },
            xAxis: {
                axisTick:{
                    show:false,
                },
                axisLabel: {  
                    interval:0,
                    rotate:-40,
                    textStyle: {
                        color: '#666',
                        fontSize:12,
                    },
                },
                axisLine:{
                    lineStyle:{
                        color:'FFD8C9',
                    }
                },
                data: ["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]
            },
            yAxis: {
                min:0,
                max:100,
                interval:25,
                splitNumber:5,
                axisLine:{       //y轴
                    lineStyle:{
                        color:'#FFD8C9'
                    }
                },
                axisLabel: {  
                    formatter:function(i){
                        return i + '%'
                    },
                    textStyle:{
                        color:'#666'
                    }
                },
                axisTick:{       //y轴刻度线
                    show:false
                },
                splitLine: {     //网格线
                    show: false
                }
            },
            series: [{
                name: '出勤率',
                type: 'bar',
                data: [5, 20, 36, 10, 10, 20,5, 20, 100, 10, 10, 20],
                barWidth: 12,
                itemStyle:{
                    marginBottom:6,
                    normal:{
                        barBorderRadius:[7, 7, 7, 7],
                        color:'#FFAB33',
                    },
                    emphasis:{
                        color:'#E74933'
                    }
                }
            }]
        };
        AttendChart.setOption(option);
    }
    //渲染访问量 图表
    function renderViewCharts(){
        var ViewChart = echarts.init(document.getElementById('party_class_container'));
        option = {
            title: {
                // text: '活动出勤率统计图',
            },
            tooltip: {
                formatter:(obj) => {
                    return `<div class="attend_tooltip">
                            <p>支部${obj.name}党课开课情况</p>
                            <p>${obj.seriesName}:${obj.data}学时</p>
                        </div>`
                }
            },
            grid: {
                left: 0,
                right: '10%',
                top:'15%',
                bottom: '15%',
                containLabel: true
            },
            xAxis: {
                axisTick:{
                    show:false,
                },
                axisLabel: {  
                    interval:0,
                    rotate:-40,
                    textStyle: {
                        color: '#666',
                        fontSize:12,
                    },
                },
                axisLine:{
                    lineStyle:{
                        color:'FFD8C9',
                    }
                },
                data: ["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]
            },
            yAxis: {
                min:0,
                max:40,
                interval:10,
                splitNumber:5,
                axisLine:{       //y轴
                    lineStyle:{
                        color:'#FFD8C9'
                    }
                },
                axisLabel: {  
                    formatter:function(i){
                        return i + '学时'
                    },
                    textStyle:{
                        color:'#666'
                    }
                },
                axisTick:{       //y轴刻度线
                    show:false
                },
                splitLine: {     //网格线
                    show: false
                }
            },
            series: [{
                name: '开课学时',
                type: 'bar',
                data: [5, 20, 36, 10, 10, 20,5, 20, 40, 10, 10, 20],
                barWidth: 12,
                itemStyle:{
                    marginBottom:6,
                    normal:{
                        barBorderRadius:[7, 7, 7, 7],
                        color:'#FFAB33',
                    },
                    emphasis:{
                        color:'#E74933'
                    }
                }
            }]
        };
        ViewChart.setOption(option);
    }
    //渲染党员组织关系转接 图表
    function renderActivityCharts(){
        var AttendChart = echarts.init(document.getElementById('party_relation_container'));
        option = {
            tooltip: {
                trigger: 'item',
                formatter:(obj) => {
                    return `<div class="attend_tooltip">
                            <p>${obj.name}:${obj.percent}%</p>
                        </div>`
                }
            },
            legend: {
                show:false
            },
            color:['#FF523A', '#FFAA17'],
            series: [
                {
                    name:'支部党员组织关系转接情况',
                    type:'pie',
                    avoidLabelOverlap: false,
                    label: {
                        show:true,
                        position:'outside'
                    },
                    labelLine: {
                        normal: {
                            show: true
                        }
                    },
                    data:[
                        {value:200, name:'女'},
                        {value:200, name:'男'},
                    ]
                }
            ]
        };
        AttendChart.setOption(option);
    }
    //渲染 党龄 图表
    function renderPartyAgeCharts(){
        var AgeChart = echarts.init(document.getElementById('party_age_container'));
        option = {
            title: {
                // text: '活动出勤率统计图',
            },
            tooltip: {
                formatter:(obj) => {
                    return `<div class="attend_tooltip">
                            <p>支部党员党龄</p>
                            <p>${obj.name}:${obj.data}人</p>
                        </div>`
                }
            },
            grid: {
                left: 0,
                right: '10%',
                top:'15%',
                bottom: '15%',
                containLabel: true
            },
            xAxis: {
                axisTick:{
                    show:false,
                },
                axisLabel: {  
                    interval:0,
                    rotate:-40,
                    textStyle: {
                        color: '#666',
                        fontSize:12,
                    },
                },
                axisLine:{
                    lineStyle:{
                        color:'FFD8C9',
                    }
                },
                data: ["小于1年","1-5年","5-10年","10-15年","15-20年","大于20年"]
            },
            yAxis: {
                min:0,
                max:100,
                interval:25,
                splitNumber:5,
                axisLine:{       //y轴
                    lineStyle:{
                        color:'#FFD8C9'
                    }
                },
                axisLabel: {  
                    formatter:function(i){
                        return i + '人'
                    },
                    textStyle:{
                        color:'#666'
                    }
                },
                axisTick:{       //y轴刻度线
                    show:false
                },
                splitLine: {     //网格线
                    show: false
                }
            },
            series: [{
                name: '支部党员党龄分布情况',
                type: 'bar',
                data: [5, 20, 36, 10, 10, 100],
                barWidth: 12,
                itemStyle:{
                    marginBottom:6,
                    normal:{
                        barBorderRadius:[7, 7, 7, 7],
                        color:'#FFAB33',
                    },
                    emphasis:{
                        color:'#E74933'
                    }
                }
            }]
        };
        AgeChart.setOption(option);
    }
</script>
</html>